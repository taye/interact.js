{"version":3,"file":"size.js","sources":["size.ts"],"sourcesContent":["// This modifier allows snapping of the size of targets during resize\n// interactions.\n\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg } from '../types'\n\nimport type { SnapOptions, SnapState } from './pointer'\nimport { snap } from './pointer'\n\nexport type SnapSizeOptions = Pick<SnapOptions, 'targets' | 'offset' | 'endOnly' | 'range' | 'enabled'>\n\nfunction start(arg: ModifierArg<SnapState>) {\n  const { state, edges } = arg\n  const { options } = state\n\n  if (!edges) {\n    return null\n  }\n\n  arg.state = {\n    options: {\n      targets: null,\n      relativePoints: [\n        {\n          x: edges.left ? 0 : 1,\n          y: edges.top ? 0 : 1,\n        },\n      ],\n      offset: options.offset || 'self',\n      origin: { x: 0, y: 0 },\n      range: options.range,\n    },\n  }\n\n  state.targetFields = state.targetFields || [\n    ['width', 'height'],\n    ['x', 'y'],\n  ]\n\n  snap.start(arg)\n  state.offsets = arg.state.offsets\n\n  arg.state = state\n}\n\nfunction set(arg) {\n  const { interaction, state, coords } = arg\n  const { options, offsets } = state\n  const relative = {\n    x: coords.x - offsets[0].x,\n    y: coords.y - offsets[0].y,\n  }\n\n  state.options = extend({}, options)\n  state.options.targets = []\n\n  for (const snapTarget of options.targets || []) {\n    let target\n\n    if (is.func(snapTarget)) {\n      target = snapTarget(relative.x, relative.y, interaction)\n    } else {\n      target = snapTarget\n    }\n\n    if (!target) {\n      continue\n    }\n\n    for (const [xField, yField] of state.targetFields) {\n      if (xField in target || yField in target) {\n        target.x = target[xField]\n        target.y = target[yField]\n\n        break\n      }\n    }\n\n    state.options.targets.push(target)\n  }\n\n  const returnValue = snap.set(arg)\n\n  state.options = options\n\n  return returnValue\n}\n\nconst defaults: SnapSizeOptions = {\n  range: Infinity,\n  targets: null,\n  offset: null,\n  endOnly: false,\n  enabled: false,\n}\n\nconst snapSize = {\n  start,\n  set,\n  defaults,\n}\n\nexport default makeModifier(snapSize, 'snapSize')\nexport { snapSize }\n"],"names":["start","arg","state","edges","options","targets","relativePoints","x","left","y","top","offset","origin","range","targetFields","snap","offsets","set","interaction","coords","relative","extend","snapTarget","target","is","func","xField","yField","push","returnValue","defaults","Infinity","endOnly","enabled","snapSize","makeModifier"],"mappings":"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"}