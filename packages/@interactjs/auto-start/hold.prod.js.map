{"version":3,"file":"hold.prod.js","sources":["hold.ts"],"sourcesContent":["import type Interaction from '@interactjs/core/Interaction'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './base'\nimport basePlugin from './base'\n/* eslint-enable */\n\ndeclare module '@interactjs/core/options' {\n  interface PerActionDefaults {\n    hold?: number\n    delay?: number\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    autoStartHoldTimer?: any\n  }\n}\n\nfunction install(scope: Scope) {\n  const { defaults } = scope\n\n  scope.usePlugin(basePlugin)\n\n  defaults.perAction.hold = 0\n  defaults.perAction.delay = 0\n}\n\nfunction getHoldDuration(interaction: Interaction) {\n  const actionName = interaction.prepared && interaction.prepared.name\n\n  if (!actionName) {\n    return null\n  }\n\n  const options = interaction.interactable.options\n\n  return options[actionName].hold || options[actionName].delay\n}\n\nconst hold: Plugin = {\n  id: 'auto-start/hold',\n  install,\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.autoStartHoldTimer = null\n    },\n\n    'autoStart:prepared': ({ interaction }) => {\n      const hold = getHoldDuration(interaction)\n\n      if (hold > 0) {\n        interaction.autoStartHoldTimer = setTimeout(() => {\n          interaction.start(interaction.prepared, interaction.interactable, interaction.element)\n        }, hold)\n      }\n    },\n\n    'interactions:move': ({ interaction, duplicate }) => {\n      if (interaction.autoStartHoldTimer && interaction.pointerWasMoved && !duplicate) {\n        clearTimeout(interaction.autoStartHoldTimer)\n        interaction.autoStartHoldTimer = null\n      }\n    },\n\n    // prevent regular down->move autoStart\n    'autoStart:before-start': ({ interaction }) => {\n      const holdDuration = getHoldDuration(interaction)\n\n      if (holdDuration > 0) {\n        interaction.prepared.name = null\n      }\n    },\n  },\n  getHoldDuration,\n}\nexport default hold\n"],"names":["install","scope","defaults","usePlugin","basePlugin","perAction","hold","delay","getHoldDuration","interaction","actionName","prepared","name","options","interactable","id","listeners","_ref","autoStartHoldTimer","_ref2","setTimeout","start","element","_ref3","duplicate","pointerWasMoved","clearTimeout","_ref4"],"mappings":";;wMAqBA,SAASA,QAAQC,GACf,MAAMC,SAAEA,GAAaD,EAErBA,EAAME,UAAUC,WAEhBF,EAASG,UAAUC,KAAO,EAC1BJ,EAASG,UAAUE,MAAQ,CAC7B,CAEA,SAASC,gBAAgBC,GACvB,MAAMC,EAAaD,EAAYE,UAAYF,EAAYE,SAASC,KAEhE,IAAKF,EACH,OAAO,KAGT,MAAMG,EAAUJ,EAAYK,aAAaD,QAEzC,OAAOA,EAAQH,GAAYJ,MAAQO,EAAQH,GAAYH,KACzD,CAEA,MAAMD,KAAe,CACnBS,GAAI,kBACJf,gBACAgB,UAAW,CACT,kBAEC,CAFmBC,GAAqB,IAApBR,YAAEA,GAAaQ,EAClCR,EAAYS,mBAAqB,IAAI,EAGvC,oBAQC,CARqBC,GAAqB,IAApBV,YAAEA,GAAaU,EACpC,MAAMb,EAAOE,gBAAgBC,GAEzBH,EAAO,IACTG,EAAYS,mBAAqBE,YAAW,KAC1CX,EAAYY,MAAMZ,EAAYE,SAAUF,EAAYK,aAAcL,EAAYa,QAAQ,GACrFhB,GACL,EAGF,mBAKC,CALoBiB,GAAgC,IAA/Bd,YAAEA,EAAWe,UAAEA,GAAWD,EAC1Cd,EAAYS,oBAAsBT,EAAYgB,kBAAoBD,IACpEE,aAAajB,EAAYS,oBACzBT,EAAYS,mBAAqB,KACnC,EAIF,wBAMA,CAN0BS,GAAqB,IAApBlB,YAAEA,GAAakB,EACnBnB,gBAAgBC,GAElB,IACjBA,EAAYE,SAASC,KAAO,KAC9B,GAGJJ"}