{"version":3,"file":"Eventable.js","sources":["Eventable.ts"],"sourcesContent":["import * as arr from '@interactjs/utils/arr'\nimport extend from '@interactjs/utils/extend'\nimport type { NormalizedListeners } from '@interactjs/utils/normalizeListeners'\nimport normalize from '@interactjs/utils/normalizeListeners'\n\nimport type { Listener, ListenersArg, Rect } from '@interactjs/core/types'\n\nfunction fireUntilImmediateStopped(event: any, listeners: Listener[]) {\n  for (const listener of listeners) {\n    if (event.immediatePropagationStopped) {\n      break\n    }\n\n    listener(event)\n  }\n}\n\nexport class Eventable {\n  options: any\n  types: NormalizedListeners = {}\n  propagationStopped = false\n  immediatePropagationStopped = false\n  global: any\n\n  constructor(options?: { [index: string]: any }) {\n    this.options = extend({}, options || {})\n  }\n\n  fire<T extends { type: string; propagationStopped?: boolean }>(event: T) {\n    let listeners: Listener[]\n    const global = this.global\n\n    // Interactable#on() listeners\n    // tslint:disable no-conditional-assignment\n    if ((listeners = this.types[event.type])) {\n      fireUntilImmediateStopped(event, listeners)\n    }\n\n    // interact.on() listeners\n    if (!event.propagationStopped && global && (listeners = global[event.type])) {\n      fireUntilImmediateStopped(event, listeners)\n    }\n  }\n\n  on(type: string, listener: ListenersArg) {\n    const listeners = normalize(type, listener)\n\n    for (type in listeners) {\n      this.types[type] = arr.merge(this.types[type] || [], listeners[type])\n    }\n  }\n\n  off(type: string, listener: ListenersArg) {\n    const listeners = normalize(type, listener)\n\n    for (type in listeners) {\n      const eventList = this.types[type]\n\n      if (!eventList || !eventList.length) {\n        continue\n      }\n\n      for (const subListener of listeners[type]) {\n        const index = eventList.indexOf(subListener)\n\n        if (index !== -1) {\n          eventList.splice(index, 1)\n        }\n      }\n    }\n  }\n\n  getRect(_element: Element): Rect {\n    return null\n  }\n}\n"],"names":["fireUntilImmediateStopped","event","listeners","listener","immediatePropagationStopped","Eventable","options","types","propagationStopped","global","constructor","extend","fire","type","on","normalize","arr","merge","off","eventList","length","subListener","index","indexOf","splice","getRect","_element"],"mappings":";;;;;;;;;;;;AAOA,SAASA,yBAAyBA,CAACC,KAAU,EAAEC,SAAqB,EAAE;AACpE,EAAA,KAAK,MAAMC,QAAQ,IAAID,SAAS,EAAE;IAChC,IAAID,KAAK,CAACG,2BAA2B,EAAE;AACrC,MAAA,MAAA;AACF,KAAA;IAEAD,QAAQ,CAACF,KAAK,CAAC,CAAA;AACjB,GAAA;AACF,CAAA;AAEO,MAAMI,SAAS,CAAC;EACrBC,OAAO,CAAA;EACPC,KAAK,GAAwB,EAAE,CAAA;AAC/BC,EAAAA,kBAAkB,GAAG,KAAK,CAAA;AAC1BJ,EAAAA,2BAA2B,GAAG,KAAK,CAAA;EACnCK,MAAM,CAAA;EAENC,WAAWA,CAACJ,OAAkC,EAAE;AAC9C,IAAA,IAAI,CAACA,OAAO,GAAGK,MAAM,CAAC,EAAE,EAAEL,OAAO,IAAI,EAAE,CAAC,CAAA;AAC1C,GAAA;EAEAM,IAAIA,CAA2DX,KAAQ,EAAE;AACvE,IAAA,IAAIC,SAAqB,CAAA;AACzB,IAAA,MAAMO,MAAM,GAAG,IAAI,CAACA,MAAM,CAAA;;AAE1B;AACA;IACA,IAAKP,SAAS,GAAG,IAAI,CAACK,KAAK,CAACN,KAAK,CAACY,IAAI,CAAC,EAAG;AACxCb,MAAAA,yBAAyB,CAACC,KAAK,EAAEC,SAAS,CAAC,CAAA;AAC7C,KAAA;;AAEA;AACA,IAAA,IAAI,CAACD,KAAK,CAACO,kBAAkB,IAAIC,MAAM,KAAKP,SAAS,GAAGO,MAAM,CAACR,KAAK,CAACY,IAAI,CAAC,CAAC,EAAE;AAC3Eb,MAAAA,yBAAyB,CAACC,KAAK,EAAEC,SAAS,CAAC,CAAA;AAC7C,KAAA;AACF,GAAA;AAEAY,EAAAA,EAAEA,CAACD,IAAY,EAAEV,QAAsB,EAAE;AACvC,IAAA,MAAMD,SAAS,GAAGa,SAAS,CAACF,IAAI,EAAEV,QAAQ,CAAC,CAAA;IAE3C,KAAKU,IAAI,IAAIX,SAAS,EAAE;MACtB,IAAI,CAACK,KAAK,CAACM,IAAI,CAAC,GAAGG,GAAG,CAACC,KAAK,CAAC,IAAI,CAACV,KAAK,CAACM,IAAI,CAAC,IAAI,EAAE,EAAEX,SAAS,CAACW,IAAI,CAAC,CAAC,CAAA;AACvE,KAAA;AACF,GAAA;AAEAK,EAAAA,GAAGA,CAACL,IAAY,EAAEV,QAAsB,EAAE;AACxC,IAAA,MAAMD,SAAS,GAAGa,SAAS,CAACF,IAAI,EAAEV,QAAQ,CAAC,CAAA;IAE3C,KAAKU,IAAI,IAAIX,SAAS,EAAE;AACtB,MAAA,MAAMiB,SAAS,GAAG,IAAI,CAACZ,KAAK,CAACM,IAAI,CAAC,CAAA;AAElC,MAAA,IAAI,CAACM,SAAS,IAAI,CAACA,SAAS,CAACC,MAAM,EAAE;AACnC,QAAA,SAAA;AACF,OAAA;AAEA,MAAA,KAAK,MAAMC,WAAW,IAAInB,SAAS,CAACW,IAAI,CAAC,EAAE;AACzC,QAAA,MAAMS,KAAK,GAAGH,SAAS,CAACI,OAAO,CAACF,WAAW,CAAC,CAAA;AAE5C,QAAA,IAAIC,KAAK,KAAK,CAAC,CAAC,EAAE;AAChBH,UAAAA,SAAS,CAACK,MAAM,CAACF,KAAK,EAAE,CAAC,CAAC,CAAA;AAC5B,SAAA;AACF,OAAA;AACF,KAAA;AACF,GAAA;EAEAG,OAAOA,CAACC,QAAiB,EAAQ;AAC/B,IAAA,OAAO,IAAI,CAAA;AACb,GAAA;AACF;;;;"}