{"version":3,"file":"DropEvent.prod.js","sources":["DropEvent.ts"],"sourcesContent":["import { BaseEvent } from '@interactjs/core/BaseEvent'\nimport type { Interactable } from '@interactjs/core/Interactable'\nimport type { InteractEvent } from '@interactjs/core/InteractEvent'\nimport type { Element } from '@interactjs/core/types'\nimport * as arr from '@interactjs/utils/arr'\n\nimport type { DropState } from './plugin'\n\nexport class DropEvent extends BaseEvent<'drag'> {\n  declare target: Element\n  dropzone: Interactable\n  dragEvent: InteractEvent<'drag'>\n  relatedTarget: Element\n  draggable: Interactable\n  propagationStopped = false\n  immediatePropagationStopped = false\n\n  /**\n   * Class of events fired on dropzones during drags with acceptable targets.\n   */\n  constructor(dropState: DropState, dragEvent: InteractEvent<'drag'>, type: string) {\n    super(dragEvent._interaction)\n\n    const { element, dropzone } = type === 'dragleave' ? dropState.prev : dropState.cur\n\n    this.type = type\n    this.target = element\n    this.currentTarget = element\n    this.dropzone = dropzone\n    this.dragEvent = dragEvent\n    this.relatedTarget = dragEvent.target\n    this.draggable = dragEvent.interactable\n    this.timeStamp = dragEvent.timeStamp\n  }\n\n  /**\n   * If this is a `dropactivate` event, the dropzone element will be\n   * deactivated.\n   *\n   * If this is a `dragmove` or `dragenter`, a `dragleave` will be fired on the\n   * dropzone element and more.\n   */\n  reject() {\n    const { dropState } = this._interaction\n\n    if (\n      this.type !== 'dropactivate' &&\n      (!this.dropzone || dropState.cur.dropzone !== this.dropzone || dropState.cur.element !== this.target)\n    ) {\n      return\n    }\n\n    dropState.prev.dropzone = this.dropzone\n    dropState.prev.element = this.target\n\n    dropState.rejected = true\n    dropState.events.enter = null\n\n    this.stopImmediatePropagation()\n\n    if (this.type === 'dropactivate') {\n      const activeDrops = dropState.activeDrops\n      const index = arr.findIndex(\n        activeDrops,\n        ({ dropzone, element }) => dropzone === this.dropzone && element === this.target,\n      )\n\n      dropState.activeDrops.splice(index, 1)\n\n      const deactivateEvent = new DropEvent(dropState, this.dragEvent, 'dropdeactivate')\n\n      deactivateEvent.dropzone = this.dropzone\n      deactivateEvent.target = this.target\n\n      this.dropzone.fire(deactivateEvent)\n    } else {\n      this.dropzone.fire(new DropEvent(dropState, this.dragEvent, 'dragleave'))\n    }\n  }\n\n  preventDefault() {}\n\n  stopPropagation() {\n    this.propagationStopped = true\n  }\n\n  stopImmediatePropagation() {\n    this.immediatePropagationStopped = this.propagationStopped = true\n  }\n}\n"],"names":["relatedTarget","dragEvent","type","_interaction","propagationStopped","immediatePropagationStopped","this","draggable","dropzone","dropState","prev","cur","element","target","currentTarget","interactable","timeStamp","reject","stopImmediatePropagation","activeDrops","index","arr","_ref","splice","deactivateEvent","DropEvent","fire","preventDefault","stopPropagation"],"mappings":";;kIAYEA,WAAAA,GAAaC,EAAAC,WACJC,cACTC,KAAAA,cAAkB,EAClBC,KAAAA,eAAAA,4BAEAC,KAAAC,eAAA,EACFD,KAAAF,oBAAA,EACAE,KAAAD,6BAAA,kBAEUJ,SAEAO,GAAS,cAAAN,EAAAO,EAAAC,KAAAD,EAAAE,IAAEH,KAAAA,KAAAA,OAAaN,OAASU,EAEvCN,KAAKJ,cAAWU,EAChBN,KAAKO,WACLP,KAAKQ,UAAab,EAClBK,KAAKE,gBAAmBK,OACxBP,KAAKL,UAAYA,EAASc,aAC1BT,KAAKN,UAAAA,EAAyBgB,SAC9B,CASJ,MAAAC,GACA,MAAAR,aAEUH,KAAAH,aAAEM,GAAAA,iBAAAA,KAAAA,MAAAA,KAAAA,UAAAA,EAAAA,IAAAA,WAAAA,KAAAA,UAAAA,EAAAA,IAAAA,UAAAA,KAAAA,OAaRA,GAPEA,EAAAC,KAAAF,SAAAF,KAAAE,SACFC,EAAAC,KAAAE,QAAAN,KAAAO,OAEAJ,EAAUC,YACVD,EAAUC,aAAe,KAEzBD,KAASS,2BACa,sBAAbhB,KAAoB,CAEzB,MAAyBiB,EAAAV,EAAEU,YAEvBC,EAAKC,iBAAqBC,QAC1BH,SACNX,EAAWI,QAERA,GAAUU,EAAEV,OAAAA,IAAAA,KAAAA,UAAAA,IAAAA,KAAAA,MAAAA,MAAcJ,YAAae,OAAKf,EAAYI,GAAuB,MACjFY,EAAA,IAAAC,UAAAhB,EAAAH,KAAAL,UAAA,kBAEDQ,EAAUU,SAAYI,KAAYf,SAElCgB,EAAMA,OAAkBlB,YAExBkB,mBAAgBhB,EAChBgB,MAEAlB,KAAKE,SAASkB,KAAKF,IAAAA,UAAAA,EAAgBlB,KAAAL,UAAA,aAEnC,CACF,cAAA0B,GAAA,CACF,eAAAC,GAEAD,KAAAA,oBAAkB,CAElBC,4BAEAtB,KAAAD,4BAAAC,KAAAF,oBAAA,CAEAc,SAEAO"}