import{Interaction as e}from"../../core/Interaction.min.js";import*as t from"../../utils/domUtils.min.js";import r from"../../utils/extend.min.js";import i from"../../utils/is.min.js";function s(e,r,s,o,n,a,c){if(!r)return!1;if(!0===r){const t=i.number(a.width)?a.width:a.right-a.left,r=i.number(a.height)?a.height:a.bottom-a.top;if(c=Math.min(c,Math.abs(("left"===e||"right"===e?t:r)/2)),t<0&&("left"===e?e="right":"right"===e&&(e="left")),r<0&&("top"===e?e="bottom":"bottom"===e&&(e="top")),"left"===e)return s.x<(t>=0?a.left:a.right)+c;if("top"===e)return s.y<(r>=0?a.top:a.bottom)+c;if("right"===e)return s.x>(t>=0?a.right:a.left)-c;if("bottom"===e)return s.y>(r>=0?a.bottom:a.top)-c}return!!i.element(o)&&(i.element(r)?r===o:t.matchesUpTo(o,r,n))}function o({iEvent:e,interaction:t}){if("resize"!==t.prepared.name||!t.resizeAxes)return;const r=e;t.interactable.options.resize.square?("y"===t.resizeAxes?r.delta.x=r.delta.y:r.delta.y=r.delta.x,r.axes="xy"):(r.axes=t.resizeAxes,"x"===t.resizeAxes?r.delta.y=0:"y"===t.resizeAxes&&(r.delta.x=0))}const n={id:"actions/resize",before:["actions/drag"],install(e){const{actions:t,browser:r,Interactable:s,defaults:o}=e;n.cursors=function(e){return e.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"}}(r),n.defaultMargin=r.supportsTouch||r.supportsPointerEvent?20:10,s.prototype.resizable=function(t){return function(e,t,r){if(i.object(t))return e.options.resize.enabled=!1!==t.enabled,e.setPerAction("resize",t),e.setOnEvents("resize",t),i.string(t.axis)&&/^x$|^y$|^xy$/.test(t.axis)?e.options.resize.axis=t.axis:null===t.axis&&(e.options.resize.axis=r.defaults.actions.resize.axis),i.bool(t.preserveAspectRatio)?e.options.resize.preserveAspectRatio=t.preserveAspectRatio:i.bool(t.square)&&(e.options.resize.square=t.square),e;if(i.bool(t))return e.options.resize.enabled=t,e;return e.options.resize}(this,t,e)},t.map.resize=n,t.methodDict.resize="resizable",o.actions.resize=n.defaults},listeners:{"interactions:new"({interaction:e}){e.resizeAxes="xy"},"interactions:action-start"(e){!function({iEvent:e,interaction:t}){if("resize"!==t.prepared.name||!t.prepared.edges)return;const i=e,s=t.rect;t._rects={start:r({},s),corrected:r({},s),previous:r({},s),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},i.edges=t.prepared.edges,i.rect=t._rects.corrected,i.deltaRect=t._rects.delta}(e),o(e)},"interactions:action-move"(e){!function({iEvent:e,interaction:t}){if("resize"!==t.prepared.name||!t.prepared.edges)return;const i=e,s=t.interactable.options.resize.invert,o="reposition"===s||"negate"===s,n=t.rect,{start:a,corrected:c,delta:l,previous:p}=t._rects;if(r(p,c),o){if(r(c,n),"reposition"===s){if(c.top>c.bottom){const e=c.top;c.top=c.bottom,c.bottom=e}if(c.left>c.right){const e=c.left;c.left=c.right,c.right=e}}}else c.top=Math.min(n.top,a.bottom),c.bottom=Math.max(n.bottom,a.top),c.left=Math.min(n.left,a.right),c.right=Math.max(n.right,a.left);c.width=c.right-c.left,c.height=c.bottom-c.top;for(const e in c)l[e]=c[e]-p[e];i.edges=t.prepared.edges,i.rect=c,i.deltaRect=l}(e),o(e)},"interactions:action-end"({iEvent:e,interaction:t}){if("resize"!==t.prepared.name||!t.prepared.edges)return;const r=e;r.edges=t.prepared.edges,r.rect=t._rects.corrected,r.deltaRect=t._rects.delta},"auto-start:check"(e){const{interaction:t,interactable:o,element:a,rect:c,buttons:l}=e;if(!c)return;const p=r({},t.coords.cur.page),f=o.options.resize;if(f&&f.enabled&&(!t.pointerIsDown||!/mouse|pointer/.test(t.pointerType)||0!=(l&f.mouseButtons))){if(i.object(f.edges)){const r={left:!1,right:!1,top:!1,bottom:!1};for(const e in r)r[e]=s(e,f.edges[e],p,t._latestPointer.eventTarget,a,c,f.margin||n.defaultMargin);r.left=r.left&&!r.right,r.top=r.top&&!r.bottom,(r.left||r.right||r.top||r.bottom)&&(e.action={name:"resize",edges:r})}else{const t="y"!==f.axis&&p.x>c.right-n.defaultMargin,r="x"!==f.axis&&p.y>c.bottom-n.defaultMargin;(t||r)&&(e.action={name:"resize",axes:(t?"x":"")+(r?"y":"")})}return!e.action&&void 0}}},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor({edges:e,axis:t,name:r}){const i=n.cursors;let s=null;if(t)s=i[r+t];else if(e){let t="";for(const r of["top","bottom","left","right"])e[r]&&(t+=r);s=i[t]}return s},defaultMargin:null};export default n;
//# sourceMappingURL=plugin.min.js.map