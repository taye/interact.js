{"version":3,"file":"interactableTargets.js","sources":["interactableTargets.ts"],"sourcesContent":["import type { Interactable } from '@interactjs/core/Interactable'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { Element } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\n\nimport type { PointerEventOptions } from '@interactjs/pointer-events/base'\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    pointerEvents(options: Partial<PointerEventOptions>): this\n    /** @internal */\n    __backCompatOption: (optionName: string, newValue: any) => any\n  }\n}\n\nfunction install(scope: Scope) {\n  const { Interactable } = scope\n\n  Interactable.prototype.pointerEvents = function (\n    this: Interactable,\n    options: Partial<PointerEventOptions>,\n  ) {\n    extend(this.events.options, options)\n\n    return this\n  }\n\n  const __backCompatOption = Interactable.prototype._backCompatOption\n\n  Interactable.prototype._backCompatOption = function (optionName, newValue) {\n    const ret = __backCompatOption.call(this, optionName, newValue)\n\n    if (ret === this) {\n      this.events.options[optionName] = newValue\n    }\n\n    return ret\n  }\n}\n\nconst plugin: Plugin = {\n  id: 'pointer-events/interactableTargets',\n  install,\n  listeners: {\n    'pointerEvents:collect-targets': ({ targets, node, type, eventTarget }, scope) => {\n      scope.interactables.forEachMatch(node, (interactable: Interactable) => {\n        const eventable = interactable.events\n        const options = eventable.options\n\n        if (\n          eventable.types[type] &&\n          eventable.types[type].length &&\n          interactable.testIgnoreAllow(options, node, eventTarget)\n        ) {\n          targets.push({\n            node,\n            eventable,\n            props: { interactable },\n          })\n        }\n      })\n    },\n\n    'interactable:new': ({ interactable }) => {\n      interactable.events.getRect = function (element: Element) {\n        return interactable.getRect(element)\n      }\n    },\n\n    'interactable:set': ({ interactable, options }, scope) => {\n      extend(interactable.events.options, scope.pointerEvents.defaults)\n      extend(interactable.events.options, options.pointerEvents || {})\n    },\n  },\n}\n\nexport default plugin\n"],"names":["install","scope","Interactable","prototype","pointerEvents","options","extend","events","__backCompatOption","_backCompatOption","optionName","newValue","ret","call","plugin","id","listeners","pointerEvents:collect-targets","_ref","targets","node","type","eventTarget","interactables","forEachMatch","interactable","eventable","types","length","testIgnoreAllow","push","props","_ref2","getRect","element","interactable:set","_ref3","defaults"],"mappings":";;;;;;;;;;AAeA,SAASA,OAAOA,CAACC,KAAY,EAAE;EAC7B,MAAM;AAAEC,IAAAA,YAAAA;AAAa,GAAC,GAAGD,KAAK,CAAA;AAE9BC,EAAAA,YAAY,CAACC,SAAS,CAACC,aAAa,GAAG,UAErCC,OAAqC,EACrC;IACAC,MAAM,CAAC,IAAI,CAACC,MAAM,CAACF,OAAO,EAAEA,OAAO,CAAC,CAAA;AAEpC,IAAA,OAAO,IAAI,CAAA;GACZ,CAAA;AAED,EAAA,MAAMG,kBAAkB,GAAGN,YAAY,CAACC,SAAS,CAACM,iBAAiB,CAAA;EAEnEP,YAAY,CAACC,SAAS,CAACM,iBAAiB,GAAG,UAAUC,UAAU,EAAEC,QAAQ,EAAE;IACzE,MAAMC,GAAG,GAAGJ,kBAAkB,CAACK,IAAI,CAAC,IAAI,EAAEH,UAAU,EAAEC,QAAQ,CAAC,CAAA;IAE/D,IAAIC,GAAG,KAAK,IAAI,EAAE;MAChB,IAAI,CAACL,MAAM,CAACF,OAAO,CAACK,UAAU,CAAC,GAAGC,QAAQ,CAAA;AAC5C,KAAA;AAEA,IAAA,OAAOC,GAAG,CAAA;GACX,CAAA;AACH,CAAA;AAEA,MAAME,MAAc,GAAG;AACrBC,EAAAA,EAAE,EAAE,oCAAoC;EACxCf,OAAO;AACPgB,EAAAA,SAAS,EAAE;AACT,IAAA,+BAA+B,EAAEC,CAAAC,IAAA,EAAuCjB,KAAK,KAAK;MAAA,IAAhD;QAAEkB,OAAO;QAAEC,IAAI;QAAEC,IAAI;AAAEC,QAAAA,WAAAA;AAAY,OAAC,GAAAJ,IAAA,CAAA;MACpEjB,KAAK,CAACsB,aAAa,CAACC,YAAY,CAACJ,IAAI,EAAGK,YAA0B,IAAK;AACrE,QAAA,MAAMC,SAAS,GAAGD,YAAY,CAAClB,MAAM,CAAA;AACrC,QAAA,MAAMF,OAAO,GAAGqB,SAAS,CAACrB,OAAO,CAAA;QAEjC,IACEqB,SAAS,CAACC,KAAK,CAACN,IAAI,CAAC,IACrBK,SAAS,CAACC,KAAK,CAACN,IAAI,CAAC,CAACO,MAAM,IAC5BH,YAAY,CAACI,eAAe,CAACxB,OAAO,EAAEe,IAAI,EAAEE,WAAW,CAAC,EACxD;UACAH,OAAO,CAACW,IAAI,CAAC;YACXV,IAAI;YACJM,SAAS;AACTK,YAAAA,KAAK,EAAE;AAAEN,cAAAA,YAAAA;AAAa,aAAA;AACxB,WAAC,CAAC,CAAA;AACJ,SAAA;AACF,OAAC,CAAC,CAAA;KACH;IAED,kBAAkB,EAAEO,KAAA,IAAsB;MAAA,IAArB;AAAEP,QAAAA,YAAAA;AAAa,OAAC,GAAAO,KAAA,CAAA;AACnCP,MAAAA,YAAY,CAAClB,MAAM,CAAC0B,OAAO,GAAG,UAAUC,OAAgB,EAAE;AACxD,QAAA,OAAOT,YAAY,CAACQ,OAAO,CAACC,OAAO,CAAC,CAAA;OACrC,CAAA;KACF;AAED,IAAA,kBAAkB,EAAEC,CAAAC,KAAA,EAA4BnC,KAAK,KAAK;MAAA,IAArC;QAAEwB,YAAY;AAAEpB,QAAAA,OAAAA;AAAQ,OAAC,GAAA+B,KAAA,CAAA;AAC5C9B,MAAAA,MAAM,CAACmB,YAAY,CAAClB,MAAM,CAACF,OAAO,EAAEJ,KAAK,CAACG,aAAa,CAACiC,QAAQ,CAAC,CAAA;AACjE/B,MAAAA,MAAM,CAACmB,YAAY,CAAClB,MAAM,CAACF,OAAO,EAAEA,OAAO,CAACD,aAAa,IAAI,EAAE,CAAC,CAAA;AAClE,KAAA;AACF,GAAA;AACF;;;;"}